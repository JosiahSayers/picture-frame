import{s as N,e as w,a0 as le,a as v,b as $,a1 as re,d as m,f as u,i as y,p as k,n as U,l as T,o as L,a2 as z,A as j,a3 as _e,r as he,G as Z,v as Y,a4 as be,E as G,x as we,I as ve,w as W,t as ke,m as ye}from"../chunks/scheduler.gdzB-wWo.js";import{S as x,i as J,t as S,g as ee,a as C,e as te,c as F,b as V,m as H,d as R,f as oe}from"../chunks/index.elnLltOd.js";import{e as ie,u as $e,o as Ie}from"../chunks/each.XQcfs4Pq.js";import{i as pe}from"../chunks/entry.uu1OocD8.js";import{s as ge,a as Se}from"../chunks/settings.store.jFlen8-b.js";import{d as Ee,w as q}from"../chunks/index.zKgYT3hc.js";import{T as Ce}from"../chunks/title.BDtqUt0a.js";const Te=!1,Le=!0;async function je({depends:l,fetch:e}){const n=await(await e("/api/images")).json();return l("custom:new-file-uploaded"),{props:n}}const tt=Object.freeze(Object.defineProperty({__proto__:null,load:je,prerender:Le,ssr:Te},Symbol.toStringTag,{value:"Module"}));function De(l){let e,t,n,a;return{c(){e=w("span"),t=le("svg"),n=le("path"),this.h()},l(s){e=v(s,"SPAN",{class:!0});var r=$(e);t=re(r,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var i=$(t);n=re(i,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),$(n).forEach(m),i.forEach(m),r.forEach(m),this.h()},h(){u(n,"stroke-linecap","round"),u(n,"stroke-linejoin","round"),u(n,"d","m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0"),u(t,"xmlns","http://www.w3.org/2000/svg"),u(t,"fill","none"),u(t,"viewBox","0 0 24 24"),u(t,"stroke-width",a=1.5*l[0]),u(t,"stroke","currentColor"),u(t,"class","w-6 h-6"),u(e,"class","text-error inline-block")},m(s,r){y(s,e,r),k(e,t),k(t,n)},p(s,[r]){r&1&&a!==(a=1.5*s[0])&&u(t,"stroke-width",a)},i:U,o:U,d(s){s&&m(e)}}}function Oe(l,e,t){let n,{bold:a=!1}=e;return l.$$set=s=>{"bold"in s&&t(1,a=s.bold)},l.$$.update=()=>{l.$$.dirty&2&&t(0,n=a?1.5:1)},[n,a]}class Me extends x{constructor(e){super(),J(this,e,Oe,De,N,{bold:1})}}function Ue(l,e){function t(n){l.contains(n.target)||e()}return document.body.addEventListener("click",t),{update(n){e=n},destroy(){document.body.removeEventListener("click",t)}}}function ce(l){let e,t,n,a,s,r;return n=new Me({props:{bold:l[2]}}),{c(){e=w("div"),t=w("button"),F(n.$$.fragment),this.h()},l(i){e=v(i,"DIV",{class:!0});var o=$(e);t=v(o,"BUTTON",{});var d=$(t);V(n.$$.fragment,d),d.forEach(m),o.forEach(m),this.h()},h(){u(e,"class","absolute top-0 w-full text-right px-4 py-3")},m(i,o){y(i,e,o),k(e,t),H(n,t,null),a=!0,s||(r=[j(t,"mouseenter",l[5]),j(t,"mouseleave",l[6]),j(t,"click",l[4])],s=!0)},p(i,o){const d={};o&4&&(d.bold=i[2]),n.$set(d)},i(i){a||(S(n.$$.fragment,i),a=!0)},o(i){C(n.$$.fragment,i),a=!1},d(i){i&&m(e),R(n),s=!1,he(r)}}}function Ne(l){let e,t,n,a,s,r,i,o=l[1]&&ce(l);return{c(){e=w("button"),t=w("img"),a=T(),o&&o.c(),this.h()},l(d){e=v(d,"BUTTON",{class:!0});var h=$(e);t=v(h,"IMG",{class:!0,src:!0,loading:!0,alt:!0}),a=L(h),o&&o.l(h),h.forEach(m),this.h()},h(){u(t,"class","object-cover aspect-square"),z(t.src,n=`/api/images/${l[0]}`)||u(t,"src",n),u(t,"loading","lazy"),u(t,"alt",l[0]),u(e,"class","relative")},m(d,h){y(d,e,h),k(e,t),k(e,a),o&&o.m(e,null),s=!0,r||(i=[j(e,"click",l[7]),_e(Ue.call(null,e,l[3]))],r=!0)},p(d,[h]){(!s||h&1&&!z(t.src,n=`/api/images/${d[0]}`))&&u(t,"src",n),(!s||h&1)&&u(t,"alt",d[0]),d[1]?o?(o.p(d,h),h&2&&S(o,1)):(o=ce(d),o.c(),S(o,1),o.m(e,null)):o&&(ee(),C(o,1,1,()=>{o=null}),te())},i(d){s||(S(o),s=!0)},o(d){C(o),s=!1},d(d){d&&m(e),o&&o.d(),r=!1,he(i)}}}function Ae(l,e,t){let{name:n}=e,a=!1,s=!1;function r(){t(1,a=!1)}async function i(){try{const g=await fetch(`/api/images/${n}`,{method:"DELETE"});pe("custom:new-file-uploaded")}catch(g){console.error(g)}}Z(()=>(document.body.addEventListener("scroll",r),()=>document.body.removeEventListener("scroll",r)));const o=()=>t(2,s=!0),d=()=>t(2,s=!1),h=()=>t(1,a=!0);return l.$$set=g=>{"name"in g&&t(0,n=g.name)},[n,a,s,r,i,o,d,h]}class Be extends x{constructor(e){super(),J(this,e,Ae,Ne,N,{name:0})}}function Pe(){const l=q([]),e=q(0),t=Ee([l,e],([s,r],i)=>{r<s.length?i(s[r]):e.set(0)}),n=q(0),a=()=>e.update(s=>s+1);return{subscribe:t.subscribe,set:s=>{l.set(s)},next:a,start:(s=10)=>{const r=s*1e3,i=setInterval(()=>a(),r);n.set(i)},stop:()=>{n.update(s=>(clearInterval(s),e.set(0),0))}}}const M=Pe();function ue(l){let e=l[4],t,n=fe(l);return{c(){n.c(),t=G()},l(a){n.l(a),t=G()},m(a,s){n.m(a,s),y(a,t,s)},p(a,s){s&16&&N(e,e=a[4])?(ee(),C(n,1,1,U),te(),n=fe(a),n.c(),S(n,1),n.m(t.parentNode,t)):n.p(a,s)},d(a){a&&m(t),n.d(a)}}}function fe(l){let e,t,n,a;return{c(){e=w("img"),this.h()},l(s){e=v(s,"IMG",{style:!0,class:!0,src:!0,loading:!0,alt:!0}),this.h()},h(){u(e,"style","max-width: 100vw"),u(e,"class","object-contain max-h-screen"),z(e.src,t=`/api/images/${l[4]}`)||u(e,"src",t),u(e,"loading","lazy"),u(e,"alt",l[4])},m(s,r){y(s,e,r),a=!0},p(s,r){l=s,(!a||r&16&&!z(e.src,t=`/api/images/${l[4]}`))&&u(e,"src",t),(!a||r&16)&&u(e,"alt",l[4])},i(s){a||(s&&we(()=>{a&&(n||(n=oe(e,l[3],{duration:l[2].transition.duration*1e3},!0)),n.run(1))}),a=!0)},o(s){s&&(n||(n=oe(e,l[3],{duration:l[2].transition.duration*1e3},!1)),n.run(0)),a=!1},d(s){s&&m(e),s&&n&&n.end()}}}function qe(l){let e,t,n,a=l[0]&&l[4]&&ue(l);return{c(){e=w("dialog"),a&&a.c(),this.h()},l(s){e=v(s,"DIALOG",{class:!0});var r=$(e);a&&a.l(r),r.forEach(m),this.h()},h(){u(e,"class","slide-show-container modal bg-black")},m(s,r){y(s,e,r),a&&a.m(e,null),l[6](e),t||(n=j(e,"click",l[5]),t=!0)},p(s,[r]){s[0]&&s[4]?a?a.p(s,r):(a=ue(s),a.c(),a.m(e,null)):a&&(a.d(1),a=null)},i:U,o:U,d(s){s&&m(e),a&&a.d(),l[6](null),t=!1,n()}}}function ze(l,e,t){let n,a;Y(l,ge,_=>t(2,n=_)),Y(l,M,_=>t(4,a=_));let{show:s}=e,r,i;const o=be();function d(_){console.log(_.key),_.key==="Escape"&&(M.stop(),h())}function h(){r.close(),o("close")}Z(()=>{document.addEventListener("keydown",d)});function g(_){ve[_?"unshift":"push"](()=>{r=_,t(1,r)})}return l.$$set=_=>{"show"in _&&t(0,s=_.show)},l.$$.update=()=>{l.$$.dirty&7&&(s?(r.show(),M.start(n.imageShownDuration)):M.stop()),l.$$.dirty&4&&t(3,i=Se[n.transition.name])},[s,r,n,i,a,h,g]}class Ge extends x{constructor(e){super(),J(this,e,ze,qe,N,{show:0})}}const X=q(""),Fe=10*1e3;function Ve(){let l;return{start:async e=>{X.set(e),l=setInterval(async()=>{const t=await fetch("/api/images/last-upload");t.ok||console.log({status:t.status,statusText:t.statusText});const n=await t.json();if(n.date===null)return;X.subscribe(s=>{const r=new Date(s),i=new Date(n.date);console.log({shouldUpdate:i>r}),i>r&&(console.log("Loading new images"),pe("custom:new-file-uploaded"),X.set(i.toISOString()))})()},Fe)},stop:()=>{clearInterval(l)}}}const He=Ve;function de(l,e,t){const n=l.slice();return n[5]=e[t],n}function Re(l){let e;return{c(){e=ke("Photos")},l(t){e=ye(t,"Photos")},m(t,n){y(t,e,n)},d(t){t&&m(e)}}}function me(l,e){let t,n,a;return n=new Be({props:{name:e[5]}}),{key:l,first:null,c(){t=G(),F(n.$$.fragment),this.h()},l(s){t=G(),V(n.$$.fragment,s),this.h()},h(){this.first=t},m(s,r){y(s,t,r),H(n,s,r),a=!0},p(s,r){e=s;const i={};r&1&&(i.name=e[5]),n.$set(i)},i(s){a||(S(n.$$.fragment,s),a=!0)},o(s){C(n.$$.fragment,s),a=!1},d(s){s&&m(t),R(n,s)}}}function xe(l){let e,t,n,a,s,r="Add Images",i,o,d="Slideshow Settings",h,g,_="Start Slideshow",A,E,b=[],se=new Map,B,I,P,K,ne;t=new Ce({props:{$$slots:{default:[Re]},$$scope:{ctx:l}}});let D=ie(l[0].props.files);const ae=c=>c[5];for(let c=0;c<D.length;c+=1){let f=de(l,D,c),p=ae(f);se.set(p,b[c]=me(p,f))}return I=new Ge({props:{show:l[1]}}),I.$on("close",l[3]),{c(){e=w("div"),F(t.$$.fragment),n=T(),a=w("div"),s=w("a"),s.textContent=r,i=T(),o=w("a"),o.textContent=d,h=T(),g=w("button"),g.textContent=_,A=T(),E=w("div");for(let c=0;c<b.length;c+=1)b[c].c();B=T(),F(I.$$.fragment),this.h()},l(c){e=v(c,"DIV",{class:!0});var f=$(e);V(t.$$.fragment,f),n=L(f),a=v(f,"DIV",{class:!0});var p=$(a);s=v(p,"A",{href:!0,class:!0,"data-svelte-h":!0}),W(s)!=="svelte-11clszc"&&(s.textContent=r),i=L(p),o=v(p,"A",{href:!0,class:!0,"data-svelte-h":!0}),W(o)!=="svelte-16lpg6u"&&(o.textContent=d),h=L(p),g=v(p,"BUTTON",{class:!0,"data-svelte-h":!0}),W(g)!=="svelte-kxhahe"&&(g.textContent=_),p.forEach(m),f.forEach(m),A=L(c),E=v(c,"DIV",{class:!0});var O=$(E);for(let Q=0;Q<b.length;Q+=1)b[Q].l(O);O.forEach(m),B=L(c),V(I.$$.fragment,c),this.h()},h(){u(s,"href","/upload"),u(s,"class","btn btn-neutral"),u(o,"href","/settings"),u(o,"class","btn btn-neutral"),u(g,"class","btn btn-primary"),u(a,"class","flex flex-wrap flex-shrink items-center justify-end gap-3"),u(e,"class","mb-10 flex justify-between items-center w-full"),u(E,"class","grid grid-cols-2 md:grid-cols-4 gap-5 justify-center")},m(c,f){y(c,e,f),H(t,e,null),k(e,n),k(e,a),k(a,s),k(a,i),k(a,o),k(a,h),k(a,g),y(c,A,f),y(c,E,f);for(let p=0;p<b.length;p+=1)b[p]&&b[p].m(E,null);y(c,B,f),H(I,c,f),P=!0,K||(ne=j(g,"click",l[2]),K=!0)},p(c,[f]){const p={};f&256&&(p.$$scope={dirty:f,ctx:c}),t.$set(p),f&1&&(D=ie(c[0].props.files),ee(),b=$e(b,f,ae,1,c,D,se,E,Ie,me,null,de),te());const O={};f&2&&(O.show=c[1]),I.$set(O)},i(c){if(!P){S(t.$$.fragment,c);for(let f=0;f<D.length;f+=1)S(b[f]);S(I.$$.fragment,c),P=!0}},o(c){C(t.$$.fragment,c);for(let f=0;f<b.length;f+=1)C(b[f]);C(I.$$.fragment,c),P=!1},d(c){c&&(m(e),m(A),m(E),m(B)),R(t);for(let f=0;f<b.length;f+=1)b[f].d();R(I,c),K=!1,ne()}}}function Je(l,e,t){let n;Y(l,ge,o=>t(4,n=o));let{data:a}=e,s=!1;Z(()=>{const{start:o,stop:d}=He();return o(a.props.lastUpdated),n.autoplay&&r(),()=>d()});async function r(){try{await document.getElementById("app").requestFullscreen()}catch(o){console.error("Couldn't start fullscreen",o)}finally{t(1,s=!0)}}async function i(){try{await document.exitFullscreen()}catch(o){console.error("Couldn't exit fullscreen",o)}finally{t(1,s=!1)}}return l.$$set=o=>{"data"in o&&t(0,a=o.data)},l.$$.update=()=>{l.$$.dirty&1&&M.set(a.props.files)},[a,s,r,i]}class st extends x{constructor(e){super(),J(this,e,Je,xe,N,{data:0})}}export{st as component,tt as universal};
