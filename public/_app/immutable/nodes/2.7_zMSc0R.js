import{s as B,e as w,a0 as ae,a as v,b as $,a1 as re,d as m,f as u,i as y,p as k,n as U,l as T,o as L,a2 as P,A as j,a3 as _e,r as he,G as Z,v as Y,a4 as be,E as z,x as we,I as ve,w as W,t as ke,m as ye}from"../chunks/scheduler.gdzB-wWo.js";import{S as x,i as J,t as I,g as ee,a as C,e as te,c as G,b as R,m as V,d as H,f as oe}from"../chunks/index.elnLltOd.js";import{e as ie,u as $e,o as Ee}from"../chunks/each.XQcfs4Pq.js";import{i as pe}from"../chunks/entry.4h1N9os8.js";import{a as ge,s as Ie}from"../chunks/settings.store._Xrc83a7.js";import{d as Se,w as A}from"../chunks/index.zKgYT3hc.js";import{T as Ce}from"../chunks/title.BDtqUt0a.js";const Te=!1,Le=!0;async function je({depends:a,fetch:e}){const n=await(await e("/api/images")).json();return a("custom:new-file-uploaded"),{props:n}}const tt=Object.freeze(Object.defineProperty({__proto__:null,load:je,prerender:Le,ssr:Te},Symbol.toStringTag,{value:"Module"}));function De(a){let e,t,n,l;return{c(){e=w("span"),t=ae("svg"),n=ae("path"),this.h()},l(s){e=v(s,"SPAN",{class:!0});var o=$(e);t=re(o,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var i=$(t);n=re(i,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),$(n).forEach(m),i.forEach(m),o.forEach(m),this.h()},h(){u(n,"stroke-linecap","round"),u(n,"stroke-linejoin","round"),u(n,"d","m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0"),u(t,"xmlns","http://www.w3.org/2000/svg"),u(t,"fill","none"),u(t,"viewBox","0 0 24 24"),u(t,"stroke-width",l=1.5*a[0]),u(t,"stroke","currentColor"),u(t,"class","w-6 h-6"),u(e,"class","text-error inline-block")},m(s,o){y(s,e,o),k(e,t),k(t,n)},p(s,[o]){o&1&&l!==(l=1.5*s[0])&&u(t,"stroke-width",l)},i:U,o:U,d(s){s&&m(e)}}}function Oe(a,e,t){let n,{bold:l=!1}=e;return a.$$set=s=>{"bold"in s&&t(1,l=s.bold)},a.$$.update=()=>{a.$$.dirty&2&&t(0,n=l?1.5:1)},[n,l]}class Me extends x{constructor(e){super(),J(this,e,Oe,De,B,{bold:1})}}function Ue(a,e){function t(n){a.contains(n.target)||e()}return document.body.addEventListener("click",t),{update(n){e=n},destroy(){document.body.removeEventListener("click",t)}}}function ce(a){let e,t,n,l,s,o;return n=new Me({props:{bold:a[2]}}),{c(){e=w("div"),t=w("button"),G(n.$$.fragment),this.h()},l(i){e=v(i,"DIV",{class:!0});var r=$(e);t=v(r,"BUTTON",{});var d=$(t);R(n.$$.fragment,d),d.forEach(m),r.forEach(m),this.h()},h(){u(e,"class","absolute top-0 w-full text-right px-4 py-3")},m(i,r){y(i,e,r),k(e,t),V(n,t,null),l=!0,s||(o=[j(t,"mouseenter",a[5]),j(t,"mouseleave",a[6]),j(t,"click",a[4])],s=!0)},p(i,r){const d={};r&4&&(d.bold=i[2]),n.$set(d)},i(i){l||(I(n.$$.fragment,i),l=!0)},o(i){C(n.$$.fragment,i),l=!1},d(i){i&&m(e),H(n),s=!1,he(o)}}}function Be(a){let e,t,n,l,s,o,i,r=a[1]&&ce(a);return{c(){e=w("button"),t=w("img"),l=T(),r&&r.c(),this.h()},l(d){e=v(d,"BUTTON",{class:!0});var h=$(e);t=v(h,"IMG",{class:!0,src:!0,loading:!0,alt:!0}),l=L(h),r&&r.l(h),h.forEach(m),this.h()},h(){u(t,"class","object-cover aspect-square"),P(t.src,n=`/api/images/${a[0]}`)||u(t,"src",n),u(t,"loading","lazy"),u(t,"alt",a[0]),u(e,"class","relative")},m(d,h){y(d,e,h),k(e,t),k(e,l),r&&r.m(e,null),s=!0,o||(i=[j(e,"click",a[7]),_e(Ue.call(null,e,a[3]))],o=!0)},p(d,[h]){(!s||h&1&&!P(t.src,n=`/api/images/${d[0]}`))&&u(t,"src",n),(!s||h&1)&&u(t,"alt",d[0]),d[1]?r?(r.p(d,h),h&2&&I(r,1)):(r=ce(d),r.c(),I(r,1),r.m(e,null)):r&&(ee(),C(r,1,1,()=>{r=null}),te())},i(d){s||(I(r),s=!0)},o(d){C(r),s=!1},d(d){d&&m(e),r&&r.d(),o=!1,he(i)}}}function Fe(a,e,t){let{name:n}=e,l=!1,s=!1;function o(){t(1,l=!1)}async function i(){try{const g=await fetch(`/api/images/${n}`,{method:"DELETE"});pe("custom:new-file-uploaded")}catch(g){console.error(g)}}Z(()=>(document.body.addEventListener("scroll",o),()=>document.body.removeEventListener("scroll",o)));const r=()=>t(2,s=!0),d=()=>t(2,s=!1),h=()=>t(1,l=!0);return a.$$set=g=>{"name"in g&&t(0,n=g.name)},[n,l,s,o,i,r,d,h]}class Ne extends x{constructor(e){super(),J(this,e,Fe,Be,B,{name:0})}}function qe(){const a=A([]),e=A(0),t=Se([a,e],([s,o],i)=>{o<s.length?i(s[o]):e.set(0)}),n=A(0),l=()=>e.update(s=>s+1);return{subscribe:t.subscribe,set:s=>{a.set(s)},next:l,start:(s=10)=>{const o=s*1e3,i=setInterval(()=>l(),o);n.set(i)},stop:()=>{n.update(s=>(clearInterval(s),e.set(0),0))}}}const M=qe();function ue(a){let e=a[4],t,n=fe(a);return{c(){n.c(),t=z()},l(l){n.l(l),t=z()},m(l,s){n.m(l,s),y(l,t,s)},p(l,s){s&16&&B(e,e=l[4])?(ee(),C(n,1,1,U),te(),n=fe(l),n.c(),I(n,1),n.m(t.parentNode,t)):n.p(l,s)},d(l){l&&m(t),n.d(l)}}}function fe(a){let e,t,n,l;return{c(){e=w("img"),this.h()},l(s){e=v(s,"IMG",{style:!0,class:!0,src:!0,loading:!0,alt:!0}),this.h()},h(){u(e,"style","max-width: 100vw"),u(e,"class","object-contain max-h-screen"),P(e.src,t=`/api/images/${a[4]}`)||u(e,"src",t),u(e,"loading","lazy"),u(e,"alt",a[4])},m(s,o){y(s,e,o),l=!0},p(s,o){a=s,(!l||o&16&&!P(e.src,t=`/api/images/${a[4]}`))&&u(e,"src",t),(!l||o&16)&&u(e,"alt",a[4])},i(s){l||(s&&we(()=>{l&&(n||(n=oe(e,a[3],{duration:a[2].transition.duration*1e3},!0)),n.run(1))}),l=!0)},o(s){s&&(n||(n=oe(e,a[3],{duration:a[2].transition.duration*1e3},!1)),n.run(0)),l=!1},d(s){s&&m(e),s&&n&&n.end()}}}function Ae(a){let e,t,n,l=a[0]&&a[4]&&ue(a);return{c(){e=w("dialog"),l&&l.c(),this.h()},l(s){e=v(s,"DIALOG",{class:!0});var o=$(e);l&&l.l(o),o.forEach(m),this.h()},h(){u(e,"class","slide-show-container modal bg-black")},m(s,o){y(s,e,o),l&&l.m(e,null),a[6](e),t||(n=j(e,"click",a[5]),t=!0)},p(s,[o]){s[0]&&s[4]?l?l.p(s,o):(l=ue(s),l.c(),l.m(e,null)):l&&(l.d(1),l=null)},i:U,o:U,d(s){s&&m(e),l&&l.d(),a[6](null),t=!1,n()}}}function Pe(a,e,t){let n,l;Y(a,ge,_=>t(2,n=_)),Y(a,M,_=>t(4,l=_));let{show:s}=e,o,i;const r=be();function d(_){console.log(_.key),_.key==="Escape"&&(M.stop(),h())}function h(){o.close(),r("close")}Z(()=>{document.addEventListener("keydown",d)});function g(_){ve[_?"unshift":"push"](()=>{o=_,t(1,o)})}return a.$$set=_=>{"show"in _&&t(0,s=_.show)},a.$$.update=()=>{a.$$.dirty&7&&(s?(o.show(),M.start(n.imageShownDuration)):M.stop()),a.$$.dirty&4&&t(3,i=Ie[n.transition.name])},[s,o,n,i,l,h,g]}class ze extends x{constructor(e){super(),J(this,e,Pe,Ae,B,{show:0})}}const X=A(""),Ge=10*1e3;function Re(){let a;return{start:async e=>{X.set(e),a=setInterval(async()=>{const t=await fetch("/api/images/last-upload");t.ok||console.log({status:t.status,statusText:t.statusText});const n=await t.json();if(n.date===null)return;X.subscribe(s=>{const o=new Date(s),i=new Date(n.date);console.log({shouldUpdate:i>o}),i>o&&(console.log("Loading new images"),pe("custom:new-file-uploaded"),X.set(i.toISOString()))})()},Ge)},stop:()=>{clearInterval(a)}}}const Ve=Re;function de(a,e,t){const n=a.slice();return n[5]=e[t],n}function He(a){let e;return{c(){e=ke("Photos")},l(t){e=ye(t,"Photos")},m(t,n){y(t,e,n)},d(t){t&&m(e)}}}function me(a,e){let t,n,l;return n=new Ne({props:{name:e[5]}}),{key:a,first:null,c(){t=z(),G(n.$$.fragment),this.h()},l(s){t=z(),R(n.$$.fragment,s),this.h()},h(){this.first=t},m(s,o){y(s,t,o),V(n,s,o),l=!0},p(s,o){e=s;const i={};o&1&&(i.name=e[5]),n.$set(i)},i(s){l||(I(n.$$.fragment,s),l=!0)},o(s){C(n.$$.fragment,s),l=!1},d(s){s&&m(t),H(n,s)}}}function xe(a){let e,t,n,l,s,o="Add Images",i,r,d="Slideshow Settings",h,g,_="Start Slideshow",F,S,b=[],se=new Map,N,E,q,K,ne;t=new Ce({props:{$$slots:{default:[He]},$$scope:{ctx:a}}});let D=ie(a[0].props.files);const le=c=>c[5];for(let c=0;c<D.length;c+=1){let f=de(a,D,c),p=le(f);se.set(p,b[c]=me(p,f))}return E=new ze({props:{show:a[1]}}),E.$on("close",a[3]),{c(){e=w("div"),G(t.$$.fragment),n=T(),l=w("div"),s=w("a"),s.textContent=o,i=T(),r=w("a"),r.textContent=d,h=T(),g=w("button"),g.textContent=_,F=T(),S=w("div");for(let c=0;c<b.length;c+=1)b[c].c();N=T(),G(E.$$.fragment),this.h()},l(c){e=v(c,"DIV",{class:!0});var f=$(e);R(t.$$.fragment,f),n=L(f),l=v(f,"DIV",{class:!0});var p=$(l);s=v(p,"A",{href:!0,class:!0,"data-svelte-h":!0}),W(s)!=="svelte-11clszc"&&(s.textContent=o),i=L(p),r=v(p,"A",{href:!0,class:!0,"data-svelte-h":!0}),W(r)!=="svelte-16lpg6u"&&(r.textContent=d),h=L(p),g=v(p,"BUTTON",{class:!0,"data-svelte-h":!0}),W(g)!=="svelte-kxhahe"&&(g.textContent=_),p.forEach(m),f.forEach(m),F=L(c),S=v(c,"DIV",{class:!0});var O=$(S);for(let Q=0;Q<b.length;Q+=1)b[Q].l(O);O.forEach(m),N=L(c),R(E.$$.fragment,c),this.h()},h(){u(s,"href","/upload"),u(s,"class","btn btn-neutral"),u(r,"href","/settings"),u(r,"class","btn btn-neutral"),u(g,"class","btn btn-primary"),u(l,"class","flex flex-wrap flex-shrink items-center justify-end gap-3"),u(e,"class","mb-10 flex justify-between items-center w-full"),u(S,"class","grid grid-cols-2 md:grid-cols-4 gap-5 justify-center")},m(c,f){y(c,e,f),V(t,e,null),k(e,n),k(e,l),k(l,s),k(l,i),k(l,r),k(l,h),k(l,g),y(c,F,f),y(c,S,f);for(let p=0;p<b.length;p+=1)b[p]&&b[p].m(S,null);y(c,N,f),V(E,c,f),q=!0,K||(ne=j(g,"click",a[2]),K=!0)},p(c,[f]){const p={};f&256&&(p.$$scope={dirty:f,ctx:c}),t.$set(p),f&1&&(D=ie(c[0].props.files),ee(),b=$e(b,f,le,1,c,D,se,S,Ee,me,null,de),te());const O={};f&2&&(O.show=c[1]),E.$set(O)},i(c){if(!q){I(t.$$.fragment,c);for(let f=0;f<D.length;f+=1)I(b[f]);I(E.$$.fragment,c),q=!0}},o(c){C(t.$$.fragment,c);for(let f=0;f<b.length;f+=1)C(b[f]);C(E.$$.fragment,c),q=!1},d(c){c&&(m(e),m(F),m(S),m(N)),H(t);for(let f=0;f<b.length;f+=1)b[f].d();H(E,c),K=!1,ne()}}}function Je(a,e,t){let n;Y(a,ge,r=>t(4,n=r));let{data:l}=e,s=!1;Z(()=>{const{start:r,stop:d}=Ve();return r(l.props.lastUpdated),n.autoplay&&o(),()=>d()});async function o(){try{const r=document.getElementById("app");typeof r.webkitEnterFullscreen!==void 0?await r.webkitEnterFullscreen():typeof r.webkitRequestFullscreen!==void 0?await r.webkitRequestFullscreen():await document.getElementById("app").requestFullscreen()}catch(r){console.error("Couldn't start fullscreen",r)}finally{t(1,s=!0)}}async function i(){try{await document.exitFullscreen()}catch(r){console.error("Couldn't exit fullscreen",r)}finally{t(1,s=!1)}}return a.$$set=r=>{"data"in r&&t(0,l=r.data)},a.$$.update=()=>{a.$$.dirty&1&&M.set(l.props.files)},[l,s,o,i]}class st extends x{constructor(e){super(),J(this,e,Je,xe,B,{data:0})}}export{st as component,tt as universal};
